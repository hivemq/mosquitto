syntax = "proto3";
package hivemq.pulse.grpc;
import "google/protobuf/timestamp.proto";
import "uuid.proto";

option java_multiple_files = true;
option java_package = "com.hivemq.pulse.agent.server.communication.message.proto";

/*
 * Based on:
 * https://protobuf.dev/programming-guides/style/
 * https://protobuf.dev/best-practices/dos-donts
 */

/*
 * A relation inside the information model graph.
 */
message RelationProto {

  /*
   * Relation metadata. This should contain information that is not necessary for computations but help with generating
   * the information model and keeping information up-to-date as well as other helpful insights.
   */
  message Metadata {

    /*
     * The version of the actual information model relation. This changes whenever an update on the relation is triggered.
     * This could be a general description change or a change of the destination or a property.
     * We might need hashes but a monotonic counting number seems fine for now.
     *
     * required
     */
    // uint64 version = 1;

    /*
     * The timestamp a relation was first introduced into the information model.
     *
     * required
     */
    google.protobuf.Timestamp created_timestamp = 2;

    /*
     * The timestamp a relation was last updated, e.g.. the description changed.
     *
     * required
     */
    google.protobuf.Timestamp updated_timestamp = 3;
  }

  /*
   * The unique identifier of a relation.
   *
   * required
   */
  UuidProto identifier = 1;

  /*
   * The specific type of a relation. To be able to add types dynamically this is a string.
   *
   * required
   */
  string type_identifier = 2;

  /*
   * The node the relation starts at.
   *
   * required
   */
  UuidProto source_node_identifier = 3;

  /*
   * The node the relation points to.
   *
   * required
   */
  UuidProto destination_node_identifier = 4;

  /*
   * The relation metadata.
   *
   * required
   */
  Metadata metadata = 5;

  /*
   * The properties of a specific relation. It is -for now- a JSON object.
   *
   * required
   */
  string properties = 6;

  /*
   * The flag if a relation computed for the RIM or created via user input
   *
   * required
   */
  bool computed = 7;
}
